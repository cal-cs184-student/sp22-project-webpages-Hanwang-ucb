<html>
<head>
<title>cs284-p4</title>
<link href="css/style.css" type="text/css" rel="stylesheet" media="all">
<link href="css/bootstrap.css" type="text/css" rel="stylesheet" media="all">

<!-- js -->
<script src="js/jquery.min.js"></script>
<script src="js/modernizr.custom.js"></script>
<!-- //js -->	
<!-- start-smoth-scrolling-->

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=AM_HTMLorMML-full"></script>
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>	
<script type="text/javascript" src="js/modernizr.custom.53451.js"></script>
<script type="text/javascript">
		jQuery(document).ready(function($) {
			$(".scroll").click(function(event){		
				event.preventDefault();
				$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
			});
		});
</script>
<!--//end-smoth-scrolling-->

</head>
<body>
<!-- <body oncontextmenu='return false' ondragstart='return false' onselectstart ='return false' onselect='document.selection.empty()' oncopy='document.selection.empty()' onbeforecopy='return false' onmouseup='document.selection.empty()'> -->
	<!--header-->
	<div class="header">
		<div class="container">
			<div class="header-class">
				<h1 style="color:white;"></a>CS284</a></h1>
			</div>
		</div>	
	</div>
	<!--//header-->
	<!--report-->
	<div class="report">
		<div class="container">
			<div class="fav-app">
				<h3>Reprot of Project 4: Cloth Simulation</h3>
				<h5 style="font-size:18px;">Han Wang</h5>				
				<h6>Submitted on April 13, 2022</h6>

				<div class="div1">
					<img src="images/P5_costume_2.png" /> </a>
				</div>
				<h5>Custom texture: Afo</h5>
				
				<h4>Overview</h4>
				<p style="font-size:20px;">In this project, a real-time discrete cloth simulator based on the system of mass and spring, which divide the cloth up into evenly spaced point masses and then connect nearby masses with springs with given dimensions and parameters. Two type of forces, external forces and spring correction forces are applied to the masses to simulate the moving. The support of collision is implemented, including cloth collision with other objects and the self-collision of cloth. Besides dynamic simulation, multiple shaders are implemented, including Diffuse, Blinn-Phong, Texture Mapping, Bump & Displacement Map, and Mirror shaders.
				
				</p>

				<h4>Part 1: Masses and springs</h4>
				

				<p style="font-size:20px;">In part 1, I implemented a point masses and springs to represents the kinetic feature of cloth, which divides the cloth body into uniformly spaced point masses connected adjacent points with springs.<br><br>

				Both <code>point_masses</code> and <code>springs</code> vectors in the cloth grid are generated by <code>Cloth::buildGrid</code>. Totoally <code>num_width_points by </code>num_height_points</code> are created spanning <code>width</code> and <code>height</code>. The <code>pinned</code> parameter of nodes are set as <code>true</code> for the mass points stay stationary. Three types of spring, structural, shearling and bending, are implemented and generated correspondingly to apply constraints between point masses.</p> 


				<p style="font-size:20px;"><b>Take some screenshots of <code>scene/pinned2.json</code> from a viewing angle where you can clearly see the cloth wireframe to show the structure of your point masses and springs.</b><br><br></p>


				<div class="div1">
					<img src="images/P1_1.png" /> </a>
				</div>
				<h5>Cloth wireframe</h5>



				<p style="font-size:20px;"><b>Show us what the wireframe looks like (1) without any shearing constraints, (2) with only shearing constraints, and (3) with all constraints.</b><br><br>
				
				<div class="div1">
					<img src="images/P1_no_shear.png" /> </a>
				</div>
				<h5>without shearing constraint</h5>

				<div class="div1">
					<img src="images/P1_only_shear.png" /> </a>
				</div>
				<h5>with only shearing constraint</h5>

				<div class="div1">
					<img src="images/P1_all.png" /> </a>
				</div>
				<h5>with all constraints</h5>



				<h4>Part 2: Simulation via numerical integration</h4>

				<p style="font-size:20px;">In this part, the moving process of point mass caused by external forces is simulated. First the total external force is directly acted on each point mass using Newton's 2nd Law based on the <code>mass</code> and <code>external_accelerations</code>. Then, for all the activited spring types, the correction forces act to the two masses on both terminal based on Hooke's law. With the forces acting on each point, the Verlet integration is implemented to obtain the value of <code>position</code> of each point mass that are not pinned in next time step. The displacement of point mass are constrainted by the changing of spring length, which could not be larger than the 10% of the rest length to avoid unreasonable deformation.

				<p style="font-size:20px;"><b>Describe the effects of changing the spring constant ks; how does the cloth behave from start to rest with a very low ks? A high ks?</b>

				
				<div class="div1">
					<img src="images/P2_ks_1.png" /> </a>
				</div>
				<h5><code>ks = 1</code></h5>

				<div class="div1">
					<img src="images/P2_ks_100.png" /> </a>
				</div>
				<h5><code>ks = 100</code></h5>
								
				<div class="div1">
					<img src="images/P2_ks_10000.png" /> </a>
				</div>
				<h5><code>ks = 10000</code></h5>
				
				<p style="font-size:20px;">By changing the spring constant parameter <code>ks</code>, the different moving feature could be observed from the video above. As the <code>ks</code> increases, the small wrinkles produced during the cloth descent decrease and the jitter after descent is reduced. This phenomenon difference was observed more significantly in the middle part of the pinned point mass.</p>

				
				<p style="font-size:20px;"><b>What about for density?</b><br><br></p>


				
				<div class="div1">
					<img src="images/P2_density_01.png" /> </a>
				</div>
				<h5><code>density = 0.1</code></h5>

				<div class="div1">
					<img src="images/P2_density_10.png" /> </a>
				</div>
				<h5><code>density = 10</code></h5>
								
				<div class="div1">
					<img src="images/P2_density_100.png" /> </a>
				</div>
				<h5><code>density = 100</code></h5>

				<p style="font-size:20px;">As the density of cloth increases, the cloth is more significantly affected by gravity, as evidenced by the more pronounced downward deformation of high-density cloth under suspension, and the consequent higher number of folds.</p>


				<p style="font-size:20px;"><b>What about for damping?</b><br><br></p>

				<div class="div1">
					<img src="images/P2_damping_01.png" /> </a>
				</div>
				<h5><code>damping = 0.1</code></h5>

				<div class="div1">
					<img src="images/P2_damping_05.png" /> </a>
				</div>
				<h5><code>damping = 0.5</code></h5>

				<div class="div1">
					<img src="images/P2_damping_10.png" /> </a>
				</div>
				<h5><code>damping = 1.0</code></h5>

				<p style="font-size:20px;">As the damping increases, the spring loses more energy during the oscillation process, of which the macroscopic manifestation is a significant decrease in the frequency of the oscillation after the cloth falls. There is also a significant change in the rate of fall of the cloth as the damping increases.<br><br>

				<h4>Part 3: Handling collisions with other objects</h4>

				<p style="font-size:20px;">The collisions with other objects feature is implemented in <code>Plane::collide</code>, which detect the mass points that going to move into the object surface and bump it back to the our side. To achieve that, the tangent point is firstly determined to find the new position of the point mass by bump it to a position slightly, by<code>SURFACE_OFFSET</code>, above the tangent point.

				<p style="font-size:20px;"><b>Show us screenshots of your shaded cloth from scene/sphere.json in its final resting state on the sphere using the default ks = 5000 as well as with ks = 500 and ks = 50000. Describe the differences in the results.</b><br><br></p>


				
				<div class="div1">
					<img src="images/P3_ks_500.png" /> </a>
				</div>
				<h5><code>ks = 500</code></h5>

				<div class="div1">
					<img src="images/P3_ks_5000.png" /> </a>
				</div>
				<h5><code>ks = 5000</code></h5>
								
				<div class="div1">
					<img src="images/P3_ks_50000.png" /> </a>
				</div>
				<h5><code>ks = 50000</code></h5>

				<p style="font-size:20px;"> In the interaction with sphere, as the value of spring constant <code>ks</code> increases, the macroscopic behavior of the cloth becomes stronger, as shown by the curvature of the cloth sagging at the top of the sphere.


				<p style="font-size:20px;"><b>Show us a screenshot of your shaded cloth lying peacefully at rest on the plane. If you haven't by now, feel free to express your colorful creativity with the cloth! (You will need to complete Part 5 first to show custom colors for anything but the "Wireframe" material.)</b><br><br></p>


				<div class="div1">
					<img src="images/P3_plane.png" /> </a>
				</div>
				<h5>Cloth on the Plane</h5>

				<h4>Part 4: Handling self-collisions</h4>
				
				<p style="font-size:20px;">The detection of self-collision is implemented using spatial hashing table which is generated in each step to maps a float to a <code>vector<PointMass *></code> storing as <code>map</code>. With the <code>map</code>, the collision could be detected and the repulsive collision force could be applied by looping through the point masses, look up the point masses that it shares the same 3D volume with.

				<p style="font-size:20px;"><b>Show us at least 3 screenshots that document how your cloth falls and folds on itself, starting with an early, initial self-collision and ending with the cloth at a more restful state (even if it is still slightly bouncy on the ground).</b><br><br></p>


				<div class="div1">
					<img src="images/P4_early.png" /> </a>
				</div>
				<h5>Early Stage</h5>

				<div class="div1">
					<img src="images/P4_self_collision.png" /> </a>
				</div>
				<h5>Initial Self-collision</h5>

				<div class="div1">
					<img src="images/P4_end.png" /> </a>
				</div>
				<h5>End Stage</h5>
				
				<p style="font-size:20px;"><b>Vary the density as well as <code>ks</code> and describe with words and screenshots how they affect the behavior of the cloth as it falls on itself.</b><br><br></p>

				<p style="font-size:20px;">
				In the scenario where the cloth is dropped vertically onto a flat surface, the decrease of cloth density shows a very similar macro effect to the increase of spring constant<code>ks</code>: the macroscopic change observed is that the size of the folds on the vertical part of cloth due to self-collision gradually increases and propagates over a larger area, which is reflected by the fact that at <code>ks=500</code> or <code>density=100</code> there are only small folds near the ground in the vertical part of the cloth, while at <code>ks=50,000</code> or <code>density=0.1</code> larger folds propagate to the top of the vertical part of the cloth. </p>

				<div class="div1">
					<img src="images/P4_ks_500.png" /> </a>
				</div>
				<h5><code>ks = 500</code></h5>

				<div class="div1">
					<img src="images/P4_ks_5000.png" /> </a>
				</div>
				<h5><code>ks = 5000</code></h5>
								
				<div class="div1">
					<img src="images/P4_ks_50000.png" /> </a>
				</div>
				<h5><code>ks = 50000</code></h5>



				<div class="div1">
					<img src="images/P4_density_01.png" /> </a>
				</div>
				<h5><code>density = 0.1</code></h5>

				<div class="div1">
					<img src="images/P4_density_10.png" /> </a>
				</div>
				<h5><code>density = 10</code></h5>
								
				<div class="div1">
					<img src="images/P4_density_100.png" /> </a>
				</div>
				<h5><code>density = 100</code></h5>

				<h4>Part 5: Sahders</h4>

				<p style="font-size:20px;"><b>Explain in your own words what is a shader program and how vertex and fragment shaders work together to create lighting and material effects.</b><br><br>

				The shader implemented in this project takes as input parameters such as texture files or colour parameters and outputs a vector containing the parameter information or operation like transformations. OpenGL shaders consist of two basic types: vertex shaders and fragment shaders. The vertex shader passes vertex attributes in the scene, and conduct the transform from the scene to normalized device coordinates, while fragment shaders assigns an color vector for each pixel.
				</p>

				<p style="font-size:20px;"><b>Explain the Blinn-Phong shading model in your own words. Show a screenshot of your Blinn-Phong shader outputting only the ambient component, a screen shot only outputting the diffuse component, a screen shot only outputting the specular component, and one using the entire Blinn-Phong model.</b><br><br>


				The Blinn-Phong shading model cooperate the contribution from ambient light, diffuse light, and specular reflections to the shading calculation. 

				Ambient light uniformly reflects out of all objects in the scenario while diffuser lighting calculates the normal of local surface relative to the illumination source, and specular reflection generate glare characteristic of glossy materials based on the illumination source position, the surface normal, and the viewer position.
				</p>


				<div class="div1">
					<img src="images/P5_ambient.png" /> </a>
				</div>
				<h5>Only the ambient component</h5>

				<div class="div1">
					<img src="images/P5_diffuse.png" /> </a>
				</div>
				<h5>Only outputting the diffuse component</h5>

				<div class="div1">
					<img src="images/P5_specular.png" /> </a>
				</div>
				<h5>Only outputting the specular component</h5>

				<div class="div1">
					<img src="images/P5_entire.png" /> </a>
				</div>
				<h5>Entire Blinn-Phong model</h5>

				<p style="font-size:20px;"><b>Show a screenshot of your texture mapping shader using your own custom texture.</b><br><br></p>


				<div class="div1">
					<img src="images/P5_costume_1.png" /> </a>
				</div>


				<div class="div1">
					<img src="images/P5_costume_2.png" /> </a>
				</div>
				<h5>Custom texture: Afo</h5>

				<p style="font-size:20px;"><b>Show a screenshot of bump mapping on the cloth and on the sphere. Compare the two approaches and resulting renders in your own words. Compare how your the two shaders react to the sphere by changing the sphere mesh's coarseness by using -o 16 -a 16 and then -o 128 -a 128.</b><br><br></p>


				<div class="div1">
					<img src="images/P5_bump_sphere_16.png" 
					style="max-width:1024px"/> </a>
				</div>
				<div class="div1">
					<img src="images/P5_bump_cloth_16.png" 
					style="max-width:1024px"/> </a>
				</div>
				<h5>Bump Mapping:<code>-o 16 -a 16</code></h5></h5>

				<div class="div1">
					<img src="images/P5_bump_sphere_128.png" 
					style="max-width:1024px"/> </a>
				</div>
				<div class="div1">
					<img src="images/P5_bump_cloth_128.png" 
					style="max-width:1024px"/> </a>
				</div>
				<h5>Bump Mapping:<code>-o 128 -a 128</code></h5></h5>

				<div class="div1">
					<img src="images/P5_displacement_sphere_16.png" 
					style="max-width:1024px"/> </a>
				</div>
				<div class="div1">
					<img src="images/P5_displacement_cloth_16.png" 
					style="max-width:1024px"/> </a>
				</div>
				<h5>Displacement Mapping:<code>-o 16 -a 16</code></h5>

				<div class="div1">
					<img src="images/P5_displacement_sphere_128.png" 
					style="max-width:1024px"/> </a>
				</div>
				<div class="div1">
					<img src="images/P5_displacement_cloth_128.png" 
					style="max-width:1024px"/> </a>
				</div>
				<h5>Displacement Mapping:<code>-o 128 -a 128</code></h5>


				<p style="font-size:20px;"><b>Show a screenshot of your mirror shader on the cloth and on the sphere.</b><br><br></p>

				<div class="div1">
					<img src="images/P5_mirror_1.png" style="max-width:1024px"/> </a>
				</div>

				<div class="div1">
					<img src="images/P5_mirror_2.png" style="max-width:1024px"/> </a>
				</div>
				<h5>Mirror Shader</h5>








				
				
	<!--//report-->
	










	<!--smooth-scrolling-of-move-up-->
		<script type="text/javascript">
			$(document).ready(function() {
				/*
				var defaults = {
					containerID: 'toTop', // fading element id
					containerHoverID: 'toTopHover', // fading element hover id
					scrollSpeed: 1200,
					easingType: 'linear' 
				};
				*/
				
				$().UItoTop({ easingType: 'easeOutQuart' });
				
			});
		</script>
		<a href="#" id="toTop" style="display: block;"> <span id="toTopHover" style="opacity: 1;"> </span></a>
	<!--//smooth-scrolling-of-move-up-->	
</body>
</html>
